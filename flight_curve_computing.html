<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Reto Schmucki" />

<meta name="date" content="2020-03-29" />

<title>Computing flight curve</title>

<script src="site_libs/jquery-1.12.4/jquery.min.js"></script>
<script src="site_libs/elevate-section-attrs-2.0/elevate-section-attrs.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="site_libs/datatables-binding-0.11/datatables.js"></script>
<link href="site_libs/dt-core-1.10.19/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="site_libs/dt-core-1.10.19/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="site_libs/dt-core-1.10.19/js/jquery.dataTables.min.js"></script>
<link href="site_libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet" />
<script src="site_libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="site_libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet" />
<script src="site_libs/selectize-0.12.0/selectize.min.js"></script>
<link href="site_libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">BMS Workshop</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    WS1
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="data_wrangling.html">data wrangling</a>
    </li>
    <li>
      <a href="mapping_site_geoclimate.html">mapping</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    WS2
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="flight_curve_presentation.html">Phenology and GAI</a>
    </li>
    <li>
      <a href="flight_curve_computing.html">Estimating phenology</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    WS3
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="site_indices.html">Site and Collated Index</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    WS4
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="species_trends.html">Species trends</a>
    </li>
    <li>
      <a href="multispecies_indicators.html">Multispecies indicators</a>
    </li>
  </ul>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Computing flight curve</h1>
<h4 class="author">Reto Schmucki</h4>
<h4 class="date">29 March 2020</h4>

</div>


<div id="generalized-abundance-index-1" class="section level3">
<h3>Generalized Abundance Index (1)</h3>
<p>Here you we will use the <code>rbms</code> package to estimate a regional flight curve for two different species, <em>Maniola jurtina</em> and <em>Polyommatus icarus</em>. We will use a subset of real data over 10 years, extracted from the eBMS database and generously provided by our colleagues in France, the UK and the Netherlands. The data have been anonymized and their spatial resolution limited to 1km accuracy, but the count are real, including the noise.</p>
<p>The bms_workshop_data folder that can be <a href="https://filedn.com/l4iF16owVCHBm81sGhdrcpX/bms_workshop_data.zip">downloaded here</a>.</p>
<p>For this section, you will need to install and load the <code>rbms</code> package available on GitHub with some explanation and documentation available <a href="https://retoschmucki.github.io/rbms/">here</a></p>
<pre><code>if(!requireNamespace(&quot;devtools&quot;)) install.packages(&quot;devtools&quot;)
devtools::install_github(&quot;RetoSchmucki/rbms&quot;)</code></pre>
<p>If you have difficulty to install the package directly, you can get the <a href="https://api.github.com/repos/RetoSchmucki/rbms/tarball/master">rbms.v_xxx.tar.gz file</a> and install from file in R or RStudio.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">library</span>(data.table)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw">library</span>(rbms)</span></code></pre></div>
<p>Here we will use the count and visit data.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>b_count_sub &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;bms_workshop_data/work_count.rds&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a>m_visit_sub &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;bms_workshop_data/work_visit.rds&quot;</span>)</span></code></pre></div>
</div>
<div id="exploring-data" class="section level3">
<h3>Exploring data</h3>
<p>Let’s first explore the data and what is in these two tables</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">library</span>(DT)</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="kw">datatable</span>(b_count_sub[<span class="dv">1</span><span class="op">:</span><span class="dv">50</span>, ], <span class="dt">rownames =</span> <span class="ot">FALSE</span>, <span class="dt">filter =</span> <span class="st">&quot;top&quot;</span>, <span class="dt">options =</span> <span class="kw">list</span>(<span class="dt">pageLength =</span> <span class="dv">5</span>, <span class="dt">scrollX =</span> T))</span></code></pre></div>
<div id="htmlwidget-3c90324bbd75fe487046" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-3c90324bbd75fe487046">{"x":{"filter":"top","filterHTML":"<tr>\n  <td data-type=\"disabled\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"1.214352e+12\" data-max=\"1534982400000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"2008\" data-max=\"2018\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"5\" data-max=\"10\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"1\" data-max=\"29\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"1\" data-max=\"32\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS"],["FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.2","FRBMS.2","FRBMS.2","FRBMS.2","FRBMS.2","FRBMS.2","FRBMS.2","FRBMS.2","FRBMS.2","FRBMS.2","FRBMS.2","FRBMS.2","FRBMS.2","FRBMS.2","FRBMS.2","FRBMS.2","FRBMS.2","FRBMS.2","FRBMS.2","FRBMS.2","FRBMS.2","FRBMS.2","FRBMS.2","FRBMS.2","FRBMS.2","FRBMS.2","FRBMS.2","FRBMS.3","FRBMS.3"],["2009-05-22","2009-08-01","2009-08-01","2009-09-19","2010-07-02","2010-08-09","2010-08-09","2011-06-27","2011-08-18","2011-09-15","2012-07-26","2012-08-10","2012-09-04","2013-08-06","2014-06-21","2014-08-23","2015-06-29","2015-08-21","2017-07-21","2017-07-21","2018-08-23","2009-05-21","2009-06-01","2010-05-23","2010-06-07","2011-06-03","2011-06-03","2012-07-22","2012-07-22","2012-08-11","2012-08-11","2012-09-09","2012-09-09","2014-06-14","2014-08-24","2014-08-24","2014-09-07","2014-09-07","2015-05-17","2016-06-25","2016-08-14","2016-08-14","2016-10-04","2017-05-27","2017-06-24","2017-06-24","2017-08-14","2017-08-14","2008-06-25","2008-07-24"],[2009,2009,2009,2009,2010,2010,2010,2011,2011,2011,2012,2012,2012,2013,2014,2014,2015,2015,2017,2017,2018,2009,2009,2010,2010,2011,2011,2012,2012,2012,2012,2012,2012,2014,2014,2014,2014,2014,2015,2016,2016,2016,2016,2017,2017,2017,2017,2017,2008,2008],[5,8,8,9,7,8,8,6,8,9,7,8,9,8,6,8,6,8,7,7,8,5,6,5,6,6,6,7,7,8,8,9,9,6,8,8,9,9,5,6,8,8,10,5,6,6,8,8,6,7],[22,1,1,19,2,9,9,27,18,15,26,10,4,6,21,23,29,21,21,21,23,21,1,23,7,3,3,22,22,11,11,9,9,14,24,24,7,7,17,25,14,14,4,27,24,24,14,14,25,24],["Maniola jurtina","Maniola jurtina","Polyommatus icarus","Polyommatus icarus","Maniola jurtina","Maniola jurtina","Polyommatus icarus","Maniola jurtina","Polyommatus icarus","Polyommatus icarus","Maniola jurtina","Maniola jurtina","Polyommatus icarus","Maniola jurtina","Maniola jurtina","Maniola jurtina","Maniola jurtina","Polyommatus icarus","Maniola jurtina","Polyommatus icarus","Maniola jurtina","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Maniola jurtina","Polyommatus icarus","Maniola jurtina","Polyommatus icarus","Maniola jurtina","Polyommatus icarus","Maniola jurtina","Polyommatus icarus","Polyommatus icarus","Maniola jurtina","Polyommatus icarus","Maniola jurtina","Polyommatus icarus","Polyommatus icarus","Maniola jurtina","Maniola jurtina","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Maniola jurtina","Polyommatus icarus","Maniola jurtina","Polyommatus icarus","Maniola jurtina","Maniola jurtina"],[5,5,2,6,20,5,18,23,2,1,32,1,1,3,17,1,9,1,3,1,5,5,3,6,5,2,3,2,4,22,17,1,5,4,13,17,9,11,1,5,5,5,3,4,3,5,2,3,11,14]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>bms_id<\/th>\n      <th>transect_id_serial<\/th>\n      <th>visit_date<\/th>\n      <th>year<\/th>\n      <th>month<\/th>\n      <th>day<\/th>\n      <th>species_name<\/th>\n      <th>count<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[3,4,5,7]}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">datatable</span>(m_visit_sub[<span class="dv">1</span><span class="op">:</span><span class="dv">50</span>, ], <span class="dt">rownames =</span> <span class="ot">FALSE</span>, <span class="dt">filter =</span> <span class="st">&quot;top&quot;</span>, <span class="dt">options =</span> <span class="kw">list</span>(<span class="dt">pageLength =</span> <span class="dv">5</span>, <span class="dt">scrollX =</span> T))</span></code></pre></div>
<div id="htmlwidget-50b81675949067bb044c" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-50b81675949067bb044c">{"x":{"filter":"top","filterHTML":"<tr>\n  <td data-type=\"disabled\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"1210550400000\" data-max=\"1534982400000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"2008\" data-max=\"2018\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"4\" data-max=\"9\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"1\" data-max=\"30\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"16\" data-max=\"40\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS","FRBMS"],["FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.1","FRBMS.2","FRBMS.2","FRBMS.2","FRBMS.2","FRBMS.2","FRBMS.2","FRBMS.2","FRBMS.2","FRBMS.2","FRBMS.2","FRBMS.2","FRBMS.2","FRBMS.2"],["2008-05-21","2008-06-30","2008-08-06","2008-09-29","2009-05-22","2009-08-01","2009-09-19","2010-05-25","2010-07-02","2010-08-09","2010-09-02","2011-04-19","2011-06-27","2011-08-18","2011-09-15","2012-05-30","2012-07-26","2012-08-10","2012-09-04","2013-06-05","2013-08-06","2013-09-03","2014-05-20","2014-06-21","2014-08-23","2014-09-24","2015-05-05","2015-05-13","2015-06-29","2015-08-21","2016-06-03","2016-08-18","2016-09-13","2017-05-09","2017-07-21","2018-05-28","2018-08-23","2008-05-12","2008-07-05","2009-04-24","2009-05-21","2009-06-01","2009-08-15","2010-05-23","2010-06-07","2010-08-22","2011-06-03","2012-07-22","2012-08-11","2012-09-09"],[2008,2008,2008,2008,2009,2009,2009,2010,2010,2010,2010,2011,2011,2011,2011,2012,2012,2012,2012,2013,2013,2013,2014,2014,2014,2014,2015,2015,2015,2015,2016,2016,2016,2017,2017,2018,2018,2008,2008,2009,2009,2009,2009,2010,2010,2010,2011,2012,2012,2012],[5,6,8,9,5,8,9,5,7,8,9,4,6,8,9,5,7,8,9,6,8,9,5,6,8,9,5,5,6,8,6,8,9,5,7,5,8,5,7,4,5,6,8,5,6,8,6,7,8,9],[21,30,6,29,22,1,19,25,2,9,2,19,27,18,15,30,26,10,4,5,6,3,20,21,23,24,5,13,29,21,3,18,13,9,21,28,23,12,5,24,21,1,15,23,7,22,3,22,11,9],[21,27,32,40,21,31,38,21,26,32,35,16,26,33,37,22,30,32,36,23,32,36,21,25,34,39,19,20,27,34,22,33,37,19,29,22,34,20,27,17,21,23,33,20,23,33,22,29,32,36]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>bms_id<\/th>\n      <th>transect_id_serial<\/th>\n      <th>visit_date<\/th>\n      <th>year<\/th>\n      <th>month<\/th>\n      <th>day<\/th>\n      <th>week<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[3,4,5,6]}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">unique</span>(b_count_sub[ , .(bms_id, species_name)])</span></code></pre></div>
<pre><code>##    bms_id       species_name
## 1:  FRBMS    Maniola jurtina
## 2:  FRBMS Polyommatus icarus
## 3:  NLBMS Polyommatus icarus
## 4:  NLBMS    Maniola jurtina
## 5:  UKBMS Polyommatus icarus
## 6:  UKBMS    Maniola jurtina</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">unique</span>(b_count_sub[<span class="kw">order</span>(year), year])</span></code></pre></div>
<pre><code>##  [1] 2008 2009 2010 2011 2012 2013 2014 2015 2016 2017 2018</code></pre>
</div>
<div id="selecting-species" class="section level3">
<h3>Selecting species</h3>
<p>The functions available in <code>rbms</code> package work on single species and within one region. This way, the function can be run on various cluster, in parallel or in <code>for loops</code>, but this is your choice and here wi will run it for a single species in one region.</p>
<ol style="list-style-type: decimal">
<li>First let’s select a species</li>
</ol>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># s_sp &lt;- &quot;Maniola jurtina&quot;</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>s_sp &lt;-<span class="st"> &quot;Polyommatus icarus&quot;</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>region_bms &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;NLBMS&quot;</span>, <span class="st">&quot;FRBMS&quot;</span>)</span></code></pre></div>
<p>In the <code>rbms</code> package, you will find two example data set with the required column names, these names are “hard coded” so they need to be exactly the same in your data sets.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw">data</span>(m_visit)</span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="kw">data</span>(m_count)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Arrange data set name to fit the functions requirements</li>
</ol>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw">setnames</span>(m_visit_sub, <span class="kw">c</span>(<span class="st">&quot;transect_id_serial&quot;</span>, <span class="st">&quot;visit_date&quot;</span>), <span class="kw">c</span>(<span class="st">&quot;SITE_ID&quot;</span>, <span class="st">&quot;DATE&quot;</span>))</span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="kw">names</span>(m_visit_sub) &lt;-<span class="st"> </span><span class="kw">toupper</span>(<span class="kw">names</span>(m_visit_sub))</span>
<span id="cb12-3"><a href="#cb12-3"></a></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="kw">setnames</span>(b_count_sub, <span class="kw">c</span>(<span class="st">&quot;transect_id_serial&quot;</span>, <span class="st">&quot;visit_date&quot;</span>, <span class="st">&quot;species_name&quot;</span>), <span class="kw">c</span>(<span class="st">&quot;SITE_ID&quot;</span>, <span class="st">&quot;DATE&quot;</span>, <span class="st">&quot;SPECIES&quot;</span>))</span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="kw">names</span>(b_count_sub) &lt;-<span class="st"> </span><span class="kw">toupper</span>(<span class="kw">names</span>(b_count_sub))</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Prepare a full time-series to align count, visit, monitoring and flight curve estimate, using the function <code>ts_dwmy_table()</code>
<ul>
<li>InitYear</li>
<li>LastYear</li>
<li>WeekDay1</li>
</ul></li>
</ol>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>ts_date &lt;-<span class="st"> </span>rbms<span class="op">::</span><span class="kw">ts_dwmy_table</span>(<span class="dt">InitYear =</span> <span class="dv">2008</span>,</span>
<span id="cb13-2"><a href="#cb13-2"></a>                               <span class="dt">LastYear =</span> <span class="dv">2017</span>,</span>
<span id="cb13-3"><a href="#cb13-3"></a>                               <span class="dt">WeekDay1 =</span> <span class="st">&quot;monday&quot;</span>)</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Define the monitoring season with the function <code>ts_monit_season()</code>
<ul>
<li>ts_date</li>
<li>StartMonth</li>
<li>EndMonth</li>
<li>StartDay</li>
<li>EndDay</li>
<li>CompltSeason</li>
<li>Anchor</li>
<li>AnchorLength</li>
<li>AnchorLag</li>
<li>TimeUnit (“d” or “w”)</li>
</ul></li>
</ol>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>ts_season &lt;-<span class="st"> </span>rbms<span class="op">::</span><span class="kw">ts_monit_season</span>(ts_date, </span>
<span id="cb14-2"><a href="#cb14-2"></a>                                   <span class="dt">StartMonth =</span> <span class="dv">4</span>,</span>
<span id="cb14-3"><a href="#cb14-3"></a>                                   <span class="dt">EndMonth =</span> <span class="dv">9</span>, </span>
<span id="cb14-4"><a href="#cb14-4"></a>                                   <span class="dt">StartDay =</span> <span class="dv">1</span>, </span>
<span id="cb14-5"><a href="#cb14-5"></a>                                   <span class="dt">EndDay =</span> <span class="ot">NULL</span>,</span>
<span id="cb14-6"><a href="#cb14-6"></a>                                   <span class="dt">CompltSeason =</span> <span class="ot">TRUE</span>,</span>
<span id="cb14-7"><a href="#cb14-7"></a>                                   <span class="dt">Anchor =</span> <span class="ot">TRUE</span>,</span>
<span id="cb14-8"><a href="#cb14-8"></a>                                   <span class="dt">AnchorLength =</span> <span class="dv">2</span>,</span>
<span id="cb14-9"><a href="#cb14-9"></a>                                   <span class="dt">AnchorLag =</span> <span class="dv">2</span>,</span>
<span id="cb14-10"><a href="#cb14-10"></a>                                   <span class="dt">TimeUnit =</span> <span class="st">&quot;w&quot;</span>)</span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Align the site visit in the region of interest with your monitoring season</li>
</ol>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>MY_visit_region &lt;-<span class="st"> </span>m_visit_sub[BMS_ID <span class="op">%in%</span><span class="st"> </span>region_bms, ]</span>
<span id="cb15-2"><a href="#cb15-2"></a>ts_season_visit &lt;-<span class="st"> </span>rbms<span class="op">::</span><span class="kw">ts_monit_site</span>(MY_visit_region, ts_season)</span></code></pre></div>
<ol start="6" style="list-style-type: decimal">
<li>Align the butterfly counts recorded for the species and region of interest with your visit and monitoring season</li>
</ol>
<p><em>Above, we already identified the species in the object <code>s_sp</code>.</em></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>MY_count_region &lt;-<span class="st"> </span>b_count_sub[BMS_ID <span class="op">%in%</span><span class="st"> </span>region_bms, ]</span>
<span id="cb16-2"><a href="#cb16-2"></a>ts_season_count &lt;-<span class="st"> </span>rbms<span class="op">::</span><span class="kw">ts_monit_count_site</span>(ts_season_visit, MY_count_region, <span class="dt">sp =</span> s_sp)</span></code></pre></div>
<ol start="7" style="list-style-type: decimal">
<li>Estimate the flight curve for a species and region of interest, using cubic spline smoother available in the <code>mgcv</code> package.
<ul>
<li>ts_season_count</li>
<li>NbrSample</li>
<li>MinVisit</li>
<li>MinOccur</li>
<li>MinNbrSite</li>
<li>MaxTrial</li>
<li>GamFamily</li>
<li>SpeedGam (logical)</li>
<li>CompltSeason (logical)</li>
<li>SelectYear</li>
<li>TimeUnit (“d” or “w”)</li>
</ul></li>
</ol>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>ts_flight_curve &lt;-<span class="st"> </span>rbms<span class="op">::</span><span class="kw">flight_curve</span>(ts_season_count,</span>
<span id="cb17-2"><a href="#cb17-2"></a>                                            <span class="dt">NbrSample =</span> <span class="dv">500</span>,</span>
<span id="cb17-3"><a href="#cb17-3"></a>                                            <span class="dt">MinVisit =</span> <span class="dv">3</span>,</span>
<span id="cb17-4"><a href="#cb17-4"></a>                                            <span class="dt">MinOccur =</span> <span class="dv">2</span>,</span>
<span id="cb17-5"><a href="#cb17-5"></a>                                            <span class="dt">MinNbrSite =</span> <span class="dv">5</span>,</span>
<span id="cb17-6"><a href="#cb17-6"></a>                                            <span class="dt">MaxTrial =</span> <span class="dv">4</span>,</span>
<span id="cb17-7"><a href="#cb17-7"></a>                                            <span class="dt">GamFamily =</span> <span class="st">&quot;nb&quot;</span>,</span>
<span id="cb17-8"><a href="#cb17-8"></a>                                            <span class="dt">SpeedGam =</span> <span class="ot">FALSE</span>,</span>
<span id="cb17-9"><a href="#cb17-9"></a>                                            <span class="dt">CompltSeason =</span> <span class="ot">TRUE</span>,</span>
<span id="cb17-10"><a href="#cb17-10"></a>                                            <span class="dt">SelectYear =</span> <span class="ot">NULL</span>,</span>
<span id="cb17-11"><a href="#cb17-11"></a>                                            <span class="dt">TimeUnit =</span> <span class="st">&quot;w&quot;</span></span>
<span id="cb17-12"><a href="#cb17-12"></a>                                            )</span>
<span id="cb17-13"><a href="#cb17-13"></a></span>
<span id="cb17-14"><a href="#cb17-14"></a><span class="kw">saveRDS</span>(ts_flight_curve, <span class="kw">file.path</span>(<span class="st">&quot;bms_workshop_data&quot;</span>, <span class="kw">paste</span>(<span class="kw">gsub</span>(<span class="st">&quot; &quot;</span>, <span class="st">&quot;_&quot;</span>, s_sp), <span class="kw">paste</span>(region_bms, <span class="dt">collapse=</span><span class="st">&quot;_&quot;</span>), <span class="st">&quot;pheno.rds&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>)))</span></code></pre></div>
<ol start="8" style="list-style-type: decimal">
<li>Extract and plot the estimated phenology</li>
</ol>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>ts_flight_curve &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="kw">file.path</span>(<span class="st">&quot;bms_workshop_data&quot;</span>, <span class="kw">paste</span>(<span class="kw">gsub</span>(<span class="st">&quot; &quot;</span>, <span class="st">&quot;_&quot;</span>, s_sp), <span class="kw">paste</span>(region_bms, <span class="dt">collapse=</span><span class="st">&quot;_&quot;</span>), <span class="st">&quot;pheno.rds&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>)))</span>
<span id="cb18-2"><a href="#cb18-2"></a></span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="kw">datatable</span>(ts_flight_curve<span class="op">$</span>pheno[<span class="dv">1</span><span class="op">:</span><span class="dv">370</span>, .(SPECIES, M_YEAR, MONTH, trimWEEKNO, WEEK_SINCE, ANCHOR, NM)], <span class="dt">rownames =</span> <span class="ot">FALSE</span>, <span class="dt">filter =</span> <span class="st">&quot;top&quot;</span>, <span class="dt">options =</span> <span class="kw">list</span>(<span class="dt">pageLength =</span> <span class="dv">5</span>, <span class="dt">scrollX =</span> T))</span></code></pre></div>
<div id="htmlwidget-e141d560bab7decf382c" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-e141d560bab7decf382c">{"x":{"filter":"top","filterHTML":"<tr>\n  <td data-type=\"disabled\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;2008&quot;,&quot;2009&quot;,&quot;2010&quot;,&quot;2011&quot;,&quot;2012&quot;,&quot;2013&quot;,&quot;2014&quot;,&quot;2015&quot;,&quot;2016&quot;,&quot;2017&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"1\" data-max=\"12\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"1\" data-max=\"54\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"1\" data-max=\"366\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"0\" data-max=\"0.24384\" data-scale=\"5\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus","Polyommatus icarus"],["2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2008","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2009","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2010","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2011","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2012","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2013","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014"],[1,1,1,1,1,2,2,2,2,3,3,3,3,3,4,4,4,4,5,5,5,5,6,6,6,6,6,7,7,7,7,8,8,8,8,9,9,9,9,9,10,10,10,10,11,11,11,11,12,12,12,12,12,1,1,1,1,1,2,2,2,2,3,3,3,3,3,4,4,4,4,5,5,5,5,6,6,6,6,6,7,7,7,8,8,8,8,8,8,9,9,9,9,10,10,10,10,11,11,11,11,11,12,12,12,12,1,1,1,1,1,2,2,2,2,3,3,3,3,3,4,4,4,4,5,5,5,5,5,6,6,6,6,7,7,7,7,8,8,8,8,8,9,9,9,9,10,10,10,10,11,11,11,11,11,12,12,12,12,1,1,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,5,6,6,6,6,7,7,7,7,8,8,8,8,8,9,9,9,9,10,10,10,10,10,11,11,11,11,12,12,12,12,1,1,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,4,5,5,5,5,6,6,6,6,7,7,7,7,7,8,8,8,8,9,9,9,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,1,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,5,6,6,6,6,7,7,7,7,7,8,8,8,8,9,9,9,9,9,10,10,10,10,11,11,11,11,12,12,12,12,12,1,1,1,1,1,2,2,2,2,3,3,3,3,3,4,4,4,4,5,5,5,5,6,6,6,6,7,7,7,7,7,8,8,8,8,9,9,9,9,9,10,10,10,10,11,11,11,11,12,12,12],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,53,49,50,51,52,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,2,3,4,5,1,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,2,3,4,5,6,1,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,2,3,4,5,6,1,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,54,50,51,52,53,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,53,49,50,51,52,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,53,49,50],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,53,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,105,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,157,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,209,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,262,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,314,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,366,362,363],[0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2e-005,0.00011,0.00053,0.00261,0.01189,0.0376,0.06155,0.04421,0.01978,0.0089,0.00631,0.00765,0.01369,0.03094,0.07347,0.14571,0.19112,0.14365,0.07698,0.04004,0.02679,0.02226,0.01808,0.01129,0.00483,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1e-005,9e-005,0.00062,0.00375,0.01714,0.04701,0.06141,0.03459,0.01289,0.00557,0.00468,0.00779,0.01898,0.04976,0.10968,0.17463,0.17394,0.10237,0.04757,0.02544,0.0219,0.02654,0.02917,0.01873,0.00573,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6e-005,9e-005,0.0001,0.00013,0.00034,0.00189,0.01235,0.04915,0.0739,0.0529,0.02711,0.01475,0.01061,0.01126,0.01953,0.05036,0.12896,0.21338,0.1697,0.08242,0.0355,0.01911,0.01271,0.00823,0.00408,0.00137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5e-005,0.00029,0.00201,0.01245,0.05055,0.11204,0.13702,0.09501,0.04096,0.01562,0.008,0.00804,0.01473,0.03405,0.06878,0.09773,0.09967,0.07594,0.04594,0.02545,0.0152,0.01133,0.01004,0.00886,0.00655,0.0037,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1e-005,9e-005,0.00113,0.00956,0.04182,0.07143,0.04802,0.02004,0.00851,0.00539,0.00544,0.00884,0.02226,0.06495,0.15037,0.19531,0.14711,0.08487,0.04942,0.03168,0.01959,0.01013,0.00402,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6e-005,0.00163,0.00042,0.00057,0.00253,0.01328,0.03571,0.04694,0.0351,0.01758,0.00807,0.00512,0.00673,0.01917,0.07046,0.18978,0.24384,0.16802,0.08001,0.03351,0.01354,0.00527,0.00197,0.0007,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2e-005,0.00024,0.00174,0.00856,0.03079,0.08001,0.12535,0.0974,0.03543,0.00988,0.00397,0.00408,0.00974,0.03183,0.08374,0.13026,0.12441,0.07802,0.03594,0.01629,0.01017,0.01172,0.01979,0.0278,0.01839,0.00443,0,0,0,0,0,0,0,0,0,0,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>SPECIES<\/th>\n      <th>M_YEAR<\/th>\n      <th>MONTH<\/th>\n      <th>trimWEEKNO<\/th>\n      <th>WEEK_SINCE<\/th>\n      <th>ANCHOR<\/th>\n      <th>NM<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6]}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<blockquote>
<p><code>rbms</code> does not contain a plot method, so you have to make your own with your favourite tool.</p>
<p><strong>Bellow is example with plot in base R</strong> <strong>I am sure you can do better!</strong></p>
</blockquote>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co">## Extract phenology part</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>pheno &lt;-<span class="st"> </span>ts_flight_curve<span class="op">$</span>pheno </span>
<span id="cb19-3"><a href="#cb19-3"></a></span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="co">## add the line of the first year</span></span>
<span id="cb19-5"><a href="#cb19-5"></a>yr &lt;-<span class="st"> </span><span class="kw">unique</span>(pheno[<span class="kw">order</span>(M_YEAR), <span class="kw">as.numeric</span>(<span class="kw">as.character</span>(M_YEAR))])</span>
<span id="cb19-6"><a href="#cb19-6"></a></span>
<span id="cb19-7"><a href="#cb19-7"></a><span class="cf">if</span>(<span class="st">&quot;trimWEEKNO&quot;</span> <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(pheno)){</span>
<span id="cb19-8"><a href="#cb19-8"></a>  <span class="kw">plot</span>(pheno[M_YEAR <span class="op">==</span><span class="st"> </span>yr[<span class="dv">1</span>], trimWEEKNO], pheno[M_YEAR <span class="op">==</span><span class="st"> </span>yr[<span class="dv">1</span>], NM], <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">max</span>(pheno[, NM])), <span class="dt">xlab =</span> <span class="st">&#39;Monitoring Week&#39;</span>, <span class="dt">ylab =</span> <span class="st">&#39;Relative Abundance&#39;</span>)</span>
<span id="cb19-9"><a href="#cb19-9"></a>} <span class="cf">else</span> {</span>
<span id="cb19-10"><a href="#cb19-10"></a>  <span class="kw">plot</span>(pheno[M_YEAR <span class="op">==</span><span class="st"> </span>yr[<span class="dv">1</span>], trimDAYNO], pheno[M_YEAR <span class="op">==</span><span class="st"> </span>yr[<span class="dv">1</span>], NM], <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">max</span>(pheno[, NM])), <span class="dt">xlab =</span> <span class="st">&#39;Monitoring Day&#39;</span>, <span class="dt">ylab =</span> <span class="st">&#39;Relative Abundance&#39;</span>)</span>
<span id="cb19-11"><a href="#cb19-11"></a></span>
<span id="cb19-12"><a href="#cb19-12"></a>}</span>
<span id="cb19-13"><a href="#cb19-13"></a></span>
<span id="cb19-14"><a href="#cb19-14"></a><span class="co">## add individual curves for additional years</span></span>
<span id="cb19-15"><a href="#cb19-15"></a><span class="cf">if</span>(<span class="kw">length</span>(yr) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>) {</span>
<span id="cb19-16"><a href="#cb19-16"></a>i &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb19-17"><a href="#cb19-17"></a>  <span class="cf">for</span>(y <span class="cf">in</span> yr[<span class="op">-</span><span class="dv">1</span>]){</span>
<span id="cb19-18"><a href="#cb19-18"></a>    <span class="cf">if</span>(<span class="st">&quot;trimWEEKNO&quot;</span> <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(pheno)){</span>
<span id="cb19-19"><a href="#cb19-19"></a>      <span class="kw">points</span>(pheno[M_YEAR <span class="op">==</span><span class="st"> </span>y , trimWEEKNO], pheno[M_YEAR <span class="op">==</span><span class="st"> </span>y, NM], <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>, <span class="dt">col =</span> i)</span>
<span id="cb19-20"><a href="#cb19-20"></a>    } <span class="cf">else</span> {</span>
<span id="cb19-21"><a href="#cb19-21"></a>      <span class="kw">points</span>(pheno[M_YEAR <span class="op">==</span><span class="st"> </span>y, trimDAYNO], pheno[M_YEAR <span class="op">==</span><span class="st"> </span>y, NM], <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>, <span class="dt">col =</span> i)</span>
<span id="cb19-22"><a href="#cb19-22"></a>    }</span>
<span id="cb19-23"><a href="#cb19-23"></a>    i &lt;-<span class="st"> </span>i <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb19-24"><a href="#cb19-24"></a>  }</span>
<span id="cb19-25"><a href="#cb19-25"></a>}</span>
<span id="cb19-26"><a href="#cb19-26"></a></span>
<span id="cb19-27"><a href="#cb19-27"></a><span class="co">## add legend</span></span>
<span id="cb19-28"><a href="#cb19-28"></a><span class="kw">legend</span>(<span class="st">&#39;topright&#39;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(yr), <span class="dt">col =</span> <span class="kw">c</span>(<span class="kw">seq_along</span>(<span class="kw">c</span>(yr))), <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">bty =</span> <span class="st">&#39;n&#39;</span>)</span></code></pre></div>
<p><img src="flight_curve_computing_files/figure-html/flight_curve_plot_2-1.png" width="672" /></p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
